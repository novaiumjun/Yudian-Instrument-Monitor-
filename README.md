# 宇电仪表多路温控记录系统 (Yudian Instrument Monitor)

🚀 **一个专为实验室环境设计的、支持多路宇电(Yudian)仪表实时温度采集、记录与可视化的工具。**

本项目基于 Python (Tkinter) 开发，特别针对 Windows 7 老旧系统进行了兼容性优化，支持 AIBUS 和 MODBUS 双协议，具备“防误触关闭”和后台运行功能。

---

## ✨ 功能特点

* **双协议支持**：同时支持宇电自有的 **AIBUS** 协议和通用的 **MODBUS-RTU** 协议，适配不同固件版本的仪表。
* **多路数据采集**：支持单根 RS485 总线上挂载多个仪表（推荐 1-10 台），实时轮询采集。
* **数据可视化**：内置 Matplotlib 绘图，实时显示温度曲线，支持查看最近 1 小时至 7 天的趋势。
* **数据持久化**：使用 SQLite 数据库自动保存历史数据，默认保留 7 天数据（可配置）。
* **数据导出**：支持一键导出 CSV 格式报表，方便 Origin/Excel 处理。
* **实验室级稳定性**：
    * 🛡️ **防误触设计**：点击窗口关闭按钮时，软件不会退出，而是最小化到系统托盘，防止实验中途因误操作导致数据中断。
    * 💻 **Win7 兼容**：代码兼容 Python 3.8，可在老旧的实验室 Windows 7 电脑上稳定运行。
    * 🔌 **断线重连**：串口异常断开后会自动尝试重连。

## 🛠️ 硬件要求

1.  **仪表**：宇电 AI-708 / 518 / 719 等系列温控仪表。
2.  **通讯模块**：仪表内部必须安装 **S (RS485)** 通讯模块（这是关键，否则无法通讯）。
3.  **连接方式**：使用 USB 转 RS485 转换器，通过双绞线将所有仪表“手拉手”串联。

## ⚙️ 仪表设置

在使用软件前，请确保仪表参数已正确设置：
1.  **Loc** = 808 (解锁参数)
2.  **Addr** = 1, 2, 3... (不同仪表设置不同地址)
3.  **bAud** = 9600 (波特率)
4.  **CoM** = 2 (若有此选项，建议设为2使用 MODBUS；若无此选项，则使用 AIBUS)

## 📦 安装与运行

### 方式一：直接运行 EXE (推荐 Win7 用户)
如果你不想安装 Python 环境，可以直接下载 Releases 中的 `.exe` 文件。
1. 下载 `LabMonitor.exe`。
2. 将其放入一个文件夹（如 `温控系统`）。
3. 双击运行即可。
   * *注意：Win7 系统如果打不开，请安装 VC++ 2015-2022 Redistributable 补丁。*

### 方式二：源码运行
如果你需要修改代码，请按以下步骤操作：

1.  **克隆项目**
    ```bash
    git clone [https://github.com/你的用户名/Yudian-Instrument-Monitor.git](https://github.com/你的用户名/Yudian-Instrument-Monitor.git)
    cd Yudian-Instrument-Monitor
    ```

2.  **安装依赖** (建议使用 Python 3.8)
    ```bash
    pip install -r requirements.txt
    ```

3.  **运行**
    ```bash
    python main.py
    ```

## 📖 使用说明

1.  **启动软件**：插入 USB 串口，运行软件。
2.  **选择端口**：在顶部选择对应的 COM 口。
3.  **选择协议**：
    * 如果仪表设置了 `CoM=2`，选择 **MODBUS**。
    * 如果仪表没有 `CoM` 选项，选择 **AIBUS**。
4.  **配置仪表**：点击菜单栏 `配置` -> `仪表参数设置`，添加你的仪表地址（Addr）和名称。
5.  **彻底退出**：软件运行后，右下角任务栏会出现蓝色小图标。**右键点击托盘图标 -> 选择“退出系统”** 才能彻底关闭程序。

## 📷 截图
*(建议在此处放一张软件运行截图，文件名为 screenshot.png)*

## 👨‍🔬 作者信息

* **作者**：马军 (Ma Jun)
* **单位**：中国科学院大连化学物理研究所 (Dalian Institute of Chemical Physics, Chinese Academy of Sciences)
* **联系方式**：novaium@qq.com

## 📄 许可证

本项目采用 MIT 许可证。欢迎科研同行用于非商业用途的实验记录。

---
*Made with ❤️ for Science.*